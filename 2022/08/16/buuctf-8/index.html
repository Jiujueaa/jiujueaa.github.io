<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF-Crypto-Wp 71~80 | Jiu jue's blog</title><meta name="keywords" content="Crypto"><meta name="author" content="Jiu jue"><meta name="copyright" content="Jiu jue"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="BUUCTF刷题笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-Crypto-Wp 71~80">
<meta property="og:url" content="http://example.com/2022/08/16/buuctf-8/index.html">
<meta property="og:site_name" content="Jiu jue&#39;s blog">
<meta property="og:description" content="BUUCTF刷题笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png">
<meta property="article:published_time" content="2022-08-15T21:23:30.000Z">
<meta property="article:modified_time" content="2022-08-15T21:23:44.420Z">
<meta property="article:author" content="Jiu jue">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="classic">
<meta property="article:tag" content="base64">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png"><link rel="shortcut icon" href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9377_cugan_noise3_4x_i1.00.PNG"><link rel="canonical" href="http://example.com/2022/08/16/buuctf-8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jiu jue","link":"链接: ","source":"来源: Jiu jue's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF-Crypto-Wp 71~80',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-16 05:23:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jiu jue's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF-Crypto-Wp 71~80</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-15T21:23:30.000Z" title="发表于 2022-08-16 05:23:30">2022-08-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-15T21:23:44.420Z" title="更新于 2022-08-16 05:23:44">2022-08-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF-Crypto-Wp 71~80"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="71-AFCTF2018-你能看出这是什么加密么"><a href="#71-AFCTF2018-你能看出这是什么加密么" class="headerlink" title="71 [AFCTF2018]你能看出这是什么加密么"></a>71 [AFCTF2018]你能看出这是什么加密么</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span><br><span class="line"></span><br><span class="line">q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span><br><span class="line"></span><br><span class="line">e=0x10001</span><br><span class="line"></span><br><span class="line">c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6   </span><br></pre></td></tr></table></figure>
<p>BABYRSA,还属于没什么变式的那种，直接解题即可：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">p=<span class="number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span></span><br><span class="line">q=<span class="number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span></span><br><span class="line">c=<span class="number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">afctf&#123;R54_|5_$0_$imp13&#125;</span><br></pre></td></tr></table></figure>
<h1 id="72-AFCTF2018-可怜的RSA"><a href="#72-AFCTF2018-可怜的RSA" class="headerlink" title="72 [AFCTF2018]可怜的RSA"></a>72 [AFCTF2018]可怜的RSA</h1><p>对public.key进行公钥分解得到e和n:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/kaijay/Downloads/attachment (19)/public.key&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    key=RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,key.n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e=&#x27;</span>,key.e)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n= 79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span><br><span class="line">e= 65537</span><br></pre></td></tr></table></figure>
<p>由于密文用了base64进行加密，我们先解密再求解明文,解题脚本如下:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/kaijay/Downloads/attachment (19)/public.key&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    key=RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,key.n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e=&#x27;</span>,key.e)</span><br><span class="line">n=key.n</span><br><span class="line">e=key.e</span><br><span class="line">p=<span class="number">3133337</span></span><br><span class="line">q=<span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/kaijay/Downloads/attachment (19)/flag.enc&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)<span class="keyword">as</span> i:</span><br><span class="line">    text=i.read()</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=<span class="built_in">int</span>(invert(e,phi))</span><br><span class="line">c_bytes = base64.b64decode(text)<span class="comment">#base64解码</span></span><br><span class="line"></span><br><span class="line">rsa_components = (n, e, d, p, q)<span class="comment">#打包密钥</span></span><br><span class="line">arsa = RSA.construct(rsa_components)</span><br><span class="line">rsakey = RSA.importKey(arsa.exportKey())</span><br><span class="line">rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line"></span><br><span class="line">decrypted = rsakey.decrypt(c_bytes)</span><br><span class="line"><span class="built_in">print</span>(decrypted)</span><br></pre></td></tr></table></figure>
<p>得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">afctf&#123;R54_|5_$0_B0rin9&#125;</span><br></pre></td></tr></table></figure>
<h1 id="73-ACTF新生赛2020-crypto-classic0"><a href="#73-ACTF新生赛2020-crypto-classic0" class="headerlink" title="73 [ACTF新生赛2020]crypto-classic0"></a>73 [ACTF新生赛2020]crypto-classic0</h1><p>Cipher:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ygvdmq[lYate[elghqvakl&#125;</span><br></pre></td></tr></table></figure>
<p>Hint:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">哼，压缩包的密码？这是小Z童鞋的生日吧==</span><br></pre></td></tr></table></figure>
<p>生日是密码，八位数字，直接爆破,由于用fcrackzip爆破的速度过慢，还是用了win里的archpr，结果：</p>
<p>Fcrackzip:</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" alt=""></p>
<p>Archer:</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105124.png" alt=""></p>
<p>效率差了百来倍</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> flag[<span class="number">25</span>] = ***</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] -= <span class="number">3</span>;</span><br><span class="line">		flag[i] ^= <span class="number">0x7</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,flag[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后得到加密脚本,先ascii位移3位，再异或运算，我们直接反着写：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> flag[<span class="number">25</span>] = <span class="string">&quot;Ygvdmq[lYate[elghqvakl&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">	    <span class="type">int</span> i;</span><br><span class="line">	    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)</span><br><span class="line">	    &#123;</span><br><span class="line">        flag[i] ^= <span class="number">0x7</span>;</span><br><span class="line">	    	flag[i] += <span class="number">3</span>;</span><br><span class="line">	    	</span><br><span class="line">	    	<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,flag[i]);</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最终output：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">actf&#123;my_naive_encrytion&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="74-RoarCTF2019-babyRSA（威尔逊定理）"><a href="#74-RoarCTF2019-babyRSA（威尔逊定理）" class="headerlink" title="74 [RoarCTF2019]babyRSA（威尔逊定理）"></a>74 [RoarCTF2019]babyRSA（威尔逊定理）</h1><p>加密脚本关键部分：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myGetPrime</span>():</span><br><span class="line">    A= getPrime(<span class="number">513</span>)</span><br><span class="line">    <span class="built_in">print</span>(A)</span><br><span class="line">    B=A-random.randint(<span class="number">1e3</span>,<span class="number">1e5</span>)</span><br><span class="line">    <span class="built_in">print</span>(B)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextPrime((B!)%A)</span><br></pre></td></tr></table></figure>
<p>这里我们知道：</p>
<script type="math/tex; mode=display">
p=(B1!)\%A1\\
q=(B2!)\%A2</script><p>威尔逊定理：</p>
<script type="math/tex; mode=display">
(A−1)!≡ −1 mod A</script><p>又因为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">B=A-random.randint(1e3,1e5)</span><br></pre></td></tr></table></figure>
<p>所以有:</p>
<script type="math/tex; mode=display">
(A−1)(A−2)(A−3)…(B+1)∗(B!)\%A=−1\%A\\
可得：\\
(A−2)(A−3)…(B+1)∗(B!)\%A=1\%A</script><p>故求</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(A−2)(A−3)…(B+1)modA的逆元就能解出p</span><br></pre></td></tr></table></figure>
<p>求解代码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_p_q</span>(<span class="params">A,B</span>):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>,A-<span class="number">1</span>):</span><br><span class="line">        tmp *= i</span><br><span class="line">        tmp %= A</span><br><span class="line">    tmp_inv = invert(tmp,A)</span><br><span class="line">    result = nextprime(tmp_inv)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<p>完整解题：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_p_q</span>(<span class="params">A,B</span>):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>,A-<span class="number">1</span>):</span><br><span class="line">        tmp *= i</span><br><span class="line">        tmp %= A</span><br><span class="line">    tmp_inv = invert(tmp,A)</span><br><span class="line">    result = nextprime(tmp_inv)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">A1=<span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line">B1=<span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line"></span><br><span class="line">A2=<span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line">B2=<span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">e=<span class="number">4097</span></span><br><span class="line">c=<span class="number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line">p=get_p_q(A1,B1)</span><br><span class="line">q=get_p_q(A2,B2)</span><br><span class="line">r=n//p//q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)<span class="comment">#由于n=p*q*r</span></span><br><span class="line"></span><br><span class="line">d=<span class="built_in">int</span>(invert(e,phi))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="75-网鼎杯-2020-青龙组-boom"><a href="#75-网鼎杯-2020-青龙组-boom" class="headerlink" title="75 [网鼎杯 2020 青龙组]boom"></a>75 [网鼎杯 2020 青龙组]boom</h1><p>直接用Hex Fiend打开可以得到一段获得flag的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Na Na Na Na </span><br><span class="line">Play a simple game</span><br><span class="line">pause</span><br><span class="line">cls</span><br><span class="line"></span><br><span class="line">first:this string md5:46e5efe6165a5afb361217446a2dbd01</span><br><span class="line">%s</span><br><span class="line">Great next level</span><br><span class="line">Game over</span><br><span class="line">This time:Here are have some formulas</span><br><span class="line">3x-y+z=185</span><br><span class="line">2x+3y-z=321</span><br><span class="line">x+y+z=173</span><br><span class="line">input: x = %d</span><br><span class="line">input: y = </span><br><span class="line">input : z = </span><br><span class="line">Great last level coming...</span><br><span class="line">Last time: Kill it</span><br><span class="line">x*x+x-7943722218936282=0</span><br><span class="line">input x: %lld</span><br><span class="line">Great This is your FLAGflag&#123;%s_%d%d%d_%lld&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先求md5，解一个三元一次方程组，解一个一元二次方程:</p>
<p>md5结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">en5oy</span><br></pre></td></tr></table></figure>
<p>解方程:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">x=Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y=Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">z=Symbol(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">f1=<span class="number">3</span>*x-y+z-<span class="number">185</span></span><br><span class="line">f2=<span class="number">2</span>*x+<span class="number">3</span>*y-z-<span class="number">321</span></span><br><span class="line">f3=x+y+z-<span class="number">173</span></span><br><span class="line">a=solve([f1,f2,f3],[x,y,z])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(solveset(Eq(x**<span class="number">2</span>+x,<span class="number">7943722218936282</span>), x, domain = S.Reals))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;x: 74, y: 68, z: 31&#125;</span><br><span class="line">&#123;-89127562, 89127561&#125;</span><br></pre></td></tr></table></figure>
<p>构造flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;en5oy_746831_89127561&#125;</span><br></pre></td></tr></table></figure>
<h1 id="76-RoarCTF2019-RSA"><a href="#76-RoarCTF2019-RSA" class="headerlink" title="76 [RoarCTF2019]RSA"></a>76 [RoarCTF2019]RSA</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">p=<span class="number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br><span class="line">q=<span class="number">139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183</span></span><br><span class="line">c=<span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>在线解p,q直接求flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;RoarCTF&#123;wm-l1l1ll1l1l1l111ll&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>正常解法:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、通过分析x,y的取值范围.</span><br><span class="line">2、枚举x,y从而得到x,y的解</span><br><span class="line">3、分析可得q与iroot(n/(x*y),2)的值相接近.从而可以得出p,q的值.</span><br></pre></td></tr></table></figure>
<h1 id="77-WUSTCTF2020-B-se"><a href="#77-WUSTCTF2020-B-se" class="headerlink" title="77 [WUSTCTF2020]B@se"></a>77 [WUSTCTF2020]B@se</h1><p>思路是：base64换+爆破解密</p>
<p>先查找少了谁：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 =<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">s=<span class="string">&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">missstr=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> s1:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> s:</span><br><span class="line">        missstr+=i</span><br><span class="line"><span class="built_in">print</span>(missstr)</span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ju34</span><br></pre></td></tr></table></figure>
<p>正常字典解密函数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">My_base64_decode</span>(<span class="params">inputs,s</span>):</span><br><span class="line">    </span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            x = <span class="built_in">str</span> ( <span class="built_in">bin</span> ( s.index ( i ) ) ).replace ( <span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">            bin_str.append ( <span class="string">&#x27;&#123;:0&gt;6&#125;&#x27;</span>.<span class="built_in">format</span> ( x ) )</span><br><span class="line"></span><br><span class="line">    outputs = <span class="string">&quot;&quot;</span></span><br><span class="line">    nums = inputs.count ( <span class="string">&#x27;=&#x27;</span> )</span><br><span class="line">    <span class="keyword">while</span> bin_str:</span><br><span class="line">        temp_list = bin_str[:<span class="number">4</span>]</span><br><span class="line">        temp_str = <span class="string">&quot;&quot;</span>.join ( temp_list )</span><br><span class="line">        <span class="comment"># print(temp_str)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span> ( temp_str ) % <span class="number">8</span> != <span class="number">0</span>):</span><br><span class="line">            temp_str = temp_str[<span class="number">0</span>:-<span class="number">1</span> * nums * <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> ( <span class="number">0</span>, <span class="built_in">int</span> ( <span class="built_in">len</span> ( temp_str ) / <span class="number">8</span> ) ):</span><br><span class="line">            outputs += <span class="built_in">chr</span> ( <span class="built_in">int</span> ( temp_str[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], <span class="number">2</span> ) )</span><br><span class="line">        bin_str = bin_str[<span class="number">4</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> outputs</span><br></pre></td></tr></table></figure>
<p>直接暴力一点，将所有<strong>ju34</strong>可能的组合都进行解密:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  itertools</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">My_base64_decode</span>(<span class="params">inputs,s</span>):</span><br><span class="line">    </span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            x = <span class="built_in">str</span> ( <span class="built_in">bin</span> ( s.index ( i ) ) ).replace ( <span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">            bin_str.append ( <span class="string">&#x27;&#123;:0&gt;6&#125;&#x27;</span>.<span class="built_in">format</span> ( x ) )</span><br><span class="line"></span><br><span class="line">    outputs = <span class="string">&quot;&quot;</span></span><br><span class="line">    nums = inputs.count ( <span class="string">&#x27;=&#x27;</span> )</span><br><span class="line">    <span class="keyword">while</span> bin_str:</span><br><span class="line">        temp_list = bin_str[:<span class="number">4</span>]</span><br><span class="line">        temp_str = <span class="string">&quot;&quot;</span>.join ( temp_list )</span><br><span class="line">        <span class="comment"># print(temp_str)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span> ( temp_str ) % <span class="number">8</span> != <span class="number">0</span>):</span><br><span class="line">            temp_str = temp_str[<span class="number">0</span>:-<span class="number">1</span> * nums * <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> ( <span class="number">0</span>, <span class="built_in">int</span> ( <span class="built_in">len</span> ( temp_str ) / <span class="number">8</span> ) ):</span><br><span class="line">            outputs += <span class="built_in">chr</span> ( <span class="built_in">int</span> ( temp_str[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], <span class="number">2</span> ) )</span><br><span class="line">        bin_str = bin_str[<span class="number">4</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#x27;</span></span><br><span class="line">s1 =<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">s=<span class="string">&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查找缺少字符</span></span><br><span class="line">missstr=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> s1:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> s:</span><br><span class="line">        missstr+=i</span><br><span class="line"><span class="comment">#print(missstr)</span></span><br><span class="line"><span class="comment"># ju34</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#列出缺少字符可能的排列组合</span></span><br><span class="line">missstrs=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(missstr, <span class="number">4</span>):</span><br><span class="line">    missstrs.append(<span class="string">&#x27;&#x27;</span>.join(i))</span><br><span class="line"><span class="built_in">print</span>(missstrs)</span><br><span class="line"><span class="comment">#列出可能的flag</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  missstrs:</span><br><span class="line">    s=<span class="string">&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs&#x27;</span>+i+<span class="string">&#x27;kxyz012789+/&#x27;</span></span><br><span class="line">    flag=My_base64_decode(cipher,s)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wctf2220&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2320&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2120&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2120&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2320&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2220&#123;bape64_p_v0ry_e@py_and_fuN&#125;</span><br><span class="line">wctf2220&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2320&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2120&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2120&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br><span class="line">wctf2320&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2220&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br><span class="line">wctf2020&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2020&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2020&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br><span class="line">wctf2020&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br><span class="line">wctf2320&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2220&#123;baqe64_q_v1ry_e@qy_and_fuN&#125;</span><br><span class="line">wctf2320&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2220&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br><span class="line">wctf2120&#123;bare64_!r_v2ry_e@ry_and_fuN&#125;</span><br><span class="line">wctf2120&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br></pre></td></tr></table></figure>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wctf2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br></pre></td></tr></table></figure>
<h1 id="78-鸡藕椒盐味"><a href="#78-鸡藕椒盐味" class="headerlink" title="78 鸡藕椒盐味"></a>78 鸡藕椒盐味</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊验证码如下：1100 1010 0000 ,而且打印的时候倒了一下。把答案哈希一下就可以提交了。</span><br></pre></td></tr></table></figure>
<p>提取关键词:</p>
<blockquote>
<p>鸡藕椒盐味  每个验证码几乎都有错误  打印的时候倒了一下</p>
</blockquote>
<p>谐音梗还是比较明显的，奇偶校验位，倒序打印：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>11</th>
<th>12</th>
<th>位数</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td>0</td>
<td>1</td>
<td>0</td>
<td></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td><strong>信息位</strong></td>
</tr>
<tr>
<td>R1</td>
<td>R2</td>
<td></td>
<td>R3</td>
<td></td>
<td></td>
<td></td>
<td>R4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>校验位</strong></td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td><strong>原码</strong></td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>海明校验位号</th>
<th>占用的校验位号</th>
<th>校验位</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>R1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>R2</td>
</tr>
<tr>
<td>3</td>
<td>1、2</td>
<td>R1 R2</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>R3</td>
</tr>
<tr>
<td>5</td>
<td>1、4</td>
<td>R1 R3</td>
</tr>
<tr>
<td>6</td>
<td>2、4</td>
<td>R2 R3</td>
</tr>
<tr>
<td>7</td>
<td>1、2、4</td>
<td>R1 R2 R3</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>R4</td>
</tr>
<tr>
<td>9</td>
<td>1、8</td>
<td>R1 R4</td>
</tr>
<tr>
<td>10</td>
<td>2、8</td>
<td>R2 R4</td>
</tr>
<tr>
<td>11</td>
<td>1、2、8</td>
<td>R1 R2 R4</td>
</tr>
<tr>
<td>12</td>
<td>4、8</td>
<td>R3 R4</td>
</tr>
</tbody>
</table>
</div>
<p>可以得到R1 R2 R3 R4分别确定了：</p>
<blockquote>
<p>R1:3 5 7 9 11</p>
<p>R2:3 6 7 10 11</p>
<p>R3:5 6 7 12</p>
<p>R4:9 10 11 12</p>
</blockquote>
<p>求校验码:</p>
<p>R1=D3⊕D5⊕D7⊕D9⊕D11=1</p>
<p>R2=D3⊕D6⊕D7⊕D10⊕D11=0</p>
<p>R3=D5⊕D6⊕D7⊕D12=0</p>
<p>R4=D9⊕D10⊕D11⊕D12=0</p>
<p>得到校验码为：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>位数</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>计算出来的校验码</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>给出的校验码</td>
</tr>
</tbody>
</table>
</div>
<p>可以发现两个校验码异或结果并不是0000而是1001，1001对应第九位，这里说明了第九位出了问题，修正后倒序输出我们得到:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1101 1010 0000</span><br></pre></td></tr></table></figure>
<p>进行哈希运算(无空格):</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">d14084c7ceca6359eaac6df3c234dd3b</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="79-AFCTF2018-Single"><a href="#79-AFCTF2018-Single" class="headerlink" title="79 [AFCTF2018]Single"></a>79 [AFCTF2018]Single</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Jmqrida rva Lfmz (JRL) eu m uqajemf seny xl enlxdomrexn uajiderc jxoqarerexnu. Rvada mda rvdaa jxooxn rcqau xl JRLu: Paxqmdyc, Mrrmjs-Yalanja mny oekay.</span><br><span class="line"></span><br><span class="line">Paxqmdyc-urcfa JRLu vmu m jxiqfa xl giaurexnu (rmusu) en dmnza xl jmrazxdeau. Lxd akmoqfa, Wab, Lxdanuej, Jdcqrx, Benmdc xd uxoarvenz afua. Ramo jmn zmen uxoa qxenru lxd atadc uxftay rmus. Oxda qxenru lxd oxda jxoqfejmray rmusu iuimffc. Rva nakr rmus en jvmen jmn ba xqanay xnfc mlrad uxoa ramo uxfta qdatexiu rmus. Rvan rva zmoa reoa eu xtad uio xl qxenru uvxwu cxi m JRL wenad. Lmoxiu akmoqfa xl uijv JRL eu Yaljxn JRL gimfu.</span><br><span class="line"></span><br><span class="line">Waff, mrrmjs-yalanja eu mnxrvad enradaurenz seny xl jxoqarerexnu. Vada atadc ramo vmu xwn narwxds(xd xnfc xna vxur) werv tifnmdmbfa uadtejau. Cxid ramo vmu reoa lxd qmrjvenz cxid uadtejau mny yatafxqenz akqfxeru iuimffc. Ux, rvan xdzmnehadu jxnnajru qmdrejeqmnru xl jxoqarerexn mny rva wmdzmoa urmdru! Cxi uvxify qdxrajr xwn uadtejau lxd yalanja qxenru mny vmjs xqqxnanru lxd mrrmjs qxenru. Veurxdejmffc rveu eu m ledur rcqa xl JRLu, atadcbxyc snxwu mbxir YAL JXN JRL - uxoarvenz fesa m Wxdfy Jiq xl mff xrvad jxoqarerexnu.</span><br><span class="line"></span><br><span class="line">Oekay jxoqarerexnu omc tmdc qxuuebfa lxdomru. Er omc ba uxoarvenz fesa wmdzmoa werv uqajemf reoa lxd rmus-bmuay afaoanru (a.z. IJUB eJRL).</span><br><span class="line"></span><br><span class="line">JRL zmoau xlran rxijv xn omnc xrvad muqajru xl enlxdomrexn uajiderc: jdcqrxzdmqvc, urazx, benmdc mnmfcueu, datadua anzanaadenz, oxbefa uajiderc mny xrvadu. Zxxy ramou zanadmffc vmta urdxnz useffu mny akqadeanja en mff rvaua euuiau.</span><br><span class="line"></span><br><span class="line">Iuimffc, lfmz eu uxoa urdenz xl dmnyxo ymrm xd rakr en uxoa lxdomr. Akmoqfa mljrl&#123;Xv_I_lxiny_er_neja_rDc&#125;</span><br></pre></td></tr></table></figure>
<p>直接导入<a target="_blank" rel="noopener" href="https://quipqiup.com/求解：">https://quipqiup.com/求解：</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Capture the Flag (CTF) is a special kind of information security competitions. There are three common types of CTFs: Jeopardy, Attack-Defence and mixed. Jeopardy-style CTFs has a couple of questions (tasks) in range of categories. For example, Web, Forensic, Crypto, Binary or something else. Team can gain some points for every solved task. More points for more complicated tasks usually. The next task in chain can be opened only after some team solve previous task. Then the game time is over sum of points shows you a CTF winer. Famous example of such CTF is Defcon CTF quals. Well, attack-defence is another interesting kind of competitions. Here every team has own network(or only one host) with vulnarable services. Your team has time for patching your services and developing exploits usually. So, then organizers connects participants of competition and the wargame starts! You should protect own services for defence points and hack opponents for attack points. Historically this is a first type of CTFs, everybody knows about DEF CON CTF - something like a World Cup of all other competitions. Mixed competitions may vary possible formats. It may be something like wargame with special time for task-based elements (e.g. UCSB iCTF). CTF games often touch on many other aspects of information security: cryptography, stego, binary analysis, reverse engeneering, mobile security and others. Good teams generally have strong skills and experience in all these issues. Usually, flag is some string of random data or text in some format. Example afctf&#123;Oh_U_found_it_nice_tRy&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">afctf&#123;Oh_U_found_it_nice_tRy&#125;</span><br></pre></td></tr></table></figure>
<h1 id="80-RSA-amp-what（base64隐写"><a href="#80-RSA-amp-what（base64隐写" class="headerlink" title="80 RSA &amp; what（base64隐写)"></a>80 RSA &amp; what（base64隐写)</h1><p>看完加密脚本后我们我们知道题目给了多组c,e1,e2和同一个n,这就要考虑共模攻击了，先上脚本看看输出:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">n=<span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line"></span><br><span class="line">e1=<span class="number">1697</span></span><br><span class="line">e2=<span class="number">599</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_gong_N_def</span>(<span class="params">e1,e2,c1,c2,n</span>):<span class="comment">#共模攻击解m</span></span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e1,e2:&quot;</span>,e1,e2)</span><br><span class="line">    <span class="built_in">print</span>(gmpy2.gcd(e1,e2))</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line">ct1_1 = <span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line">ct2_1 = <span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line"></span><br><span class="line">ct1_2 = <span class="number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span></span><br><span class="line">ct2_2 = <span class="number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span></span><br><span class="line"></span><br><span class="line">ct1_3 = <span class="number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span></span><br><span class="line">ct2_3 = <span class="number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span></span><br><span class="line"></span><br><span class="line">ct1_4 = <span class="number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span></span><br><span class="line">ct2_4 = <span class="number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span></span><br><span class="line"></span><br><span class="line">ct1_5 = <span class="number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span></span><br><span class="line">ct2_5 = <span class="number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span></span><br><span class="line"></span><br><span class="line">ct1_6 = <span class="number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span></span><br><span class="line">ct2_6 = <span class="number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span></span><br><span class="line"></span><br><span class="line">ct1 = []</span><br><span class="line">ct2 = []</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">    ct1.append(<span class="built_in">eval</span>(<span class="string">&quot;ct1_&quot;</span>+<span class="built_in">str</span>(i)))</span><br><span class="line">    ct2.append(<span class="built_in">eval</span>(<span class="string">&quot;ct2_&quot;</span> + <span class="built_in">str</span>(i)))</span><br><span class="line">    flag += <span class="built_in">str</span>(long_to_bytes(rsa_gong_N_def(e1,e2,ct1[i-<span class="number">1</span>],ct2[i-<span class="number">1</span>],n)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VEhJUz==    RkxBR3==    SVN=    SElEREVOLo==    Q0FO    WU9V    RklORM==    SVT=    T1VUP4==    RE8=    WU9V    S05PV9==    QkFTRTY0P5==    WW91bmdD    VEhJTku=    WU9V    QVJF    Tk9U    VEhBVE==    RkFNSUxJQVI=    V0lUSO==    QkFTRTY0Lh==    QmFzZTY0    aXO=    YW==    Z3JvdXA=    b2b=    c2ltaWxhcn==    YmluYXJ5LXRvLXRleHR=    ZW5jb2Rpbme=    c2NoZW1lc0==    dGhhdD==    cmVwcmVzZW50    YmluYXJ5    ZGF0YW==    aW5=    YW6=    QVNDSUl=    c3RyaW5n    Zm9ybWF0    Ynk=    dHJhbnNsYXRpbmd=    aXS=    aW50b1==    YT==    cmFkaXgtNjQ=    cmVwcmVzZW50YXRpb24u    VGhl    dGVybc==    QmFzZTY0    b3JpZ2luYXRlc8==    ZnJvbd==    YY==    c3BlY2lmaWN=    TUlNRT==    Y29udGVudI==    dHJhbnNmZXI=    ZW5jb2Rpbmcu    VGhl    cGFydGljdWxhct==    c2V0    b2b=    NjR=    Y2hhcmFjdGVyc5==    Y2hvc2Vu    dG+=    cmVwcmVzZW50    dGhl    NjQ=    cGxhY2UtdmFsdWVz    Zm9y    dGhl    YmFzZd==    dmFyaWVz    YmV0d2Vlbt==    aW1wbGVtZW50YXRpb25zLp==    VGhl    Z2VuZXJhbI==    c3RyYXRlZ3n=    aXO=    dG9=    Y2hvb3Nl    NjR=    Y2hhcmFjdGVyc5==    dGhhdA==    YXJl    Ym90aN==    bWVtYmVyc5==    b2a=    YS==    c3Vic2V0    Y29tbW9u    dG8=    bW9zdM==    ZW5jb2RpbmdzLA==    YW5k    YWxzb8==    cHJpbnRhYmxlLg==    VGhpc9==    Y29tYmluYXRpb25=    bGVhdmVz    dGhl    ZGF0YW==    dW5saWtlbHk=    dG/=    YmV=    bW9kaWZpZWS=    aW5=    dHJhbnNpdE==    dGhyb3VnaN==    aW5mb3JtYXRpb26=    c3lzdGVtcyw=    c3VjaN==    YXM=    RS1tYWlsLD==    dGhhdA==    d2VyZQ==    dHJhZGl0aW9uYWxseQ==    bm90    OC1iaXQ=    Y2xlYW4uWzFd    Rm9y    ZXhhbXBsZSw=    TUlNRSdz    QmFzZTY0    aW1wbGVtZW50YXRpb24=    dXNlcw==    QahDWiw=    YahDeiw=    YW5k    MKhDOQ==    Zm9y    dGhl    Zmlyc3Q=    NjI=    dmFsdWVzLg==    T3RoZXI=    dmFyaWF0aW9ucw==    c2hhcmU=    dGhpcw==    cHJvcGVydHk=    YnV0    ZGlmZmVy    aW4=    dGhl    c3ltYm9scw==    Y2hvc2Vu    Zm9y    dGhl    bGFzdA==    dHdv    dmFsdWVzOw==    YW4=    ZXhhbXBsZQ==    aXM=    VVRGLTcu   </span><br></pre></td></tr></table></figure>
<p>得到这么多段短的base64加密，解码结果告诉我们flag被隐写了，参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/vict0r/p/13282901.html">大佬blog</a>我们能得到base64隐写原理:</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220727112435.png" alt=""></p>
<p>即使将补位的0进行篡改，也不会改变原来的编码结果，这就给我们留下了隐写的空间，直接上脚本破解：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">c = <span class="string">b&#x27;VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbme=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI==\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3VnaN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFsdWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    base64chars = <span class="string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_stego</span>():</span><br><span class="line">    line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    bin_str=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        k=long_to_bytes(i)</span><br><span class="line">        <span class="keyword">if</span> k==<span class="string">b&#x27;\n&#x27;</span>:</span><br><span class="line">            steg_line = line</span><br><span class="line">            norm_line = base64.b64encode(base64.b64decode(line))</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="comment">#print(diff)</span></span><br><span class="line">            pads_num = steg_line.count(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += <span class="built_in">bin</span>(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span>(goflag(bin_str))</span><br><span class="line">            line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        line+=k</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">goflag</span>(<span class="params">bin_str</span>):</span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += <span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7</span><br><span class="line">7</span><br><span class="line">7</span><br><span class="line">7</span><br><span class="line">7</span><br><span class="line">7c</span><br><span class="line">7c</span><br><span class="line">7c8</span><br><span class="line">7c8</span><br><span class="line">7c8</span><br><span class="line">7c8</span><br><span class="line">7c86</span><br><span class="line">7c86</span><br><span class="line">7c86</span><br><span class="line">7c86</span><br><span class="line">7c86</span><br><span class="line">7c86</span><br><span class="line">7c86d</span><br><span class="line">7c86d</span><br><span class="line">7c86d</span><br><span class="line">7c86d8</span><br><span class="line">7c86d8</span><br><span class="line">7c86d8</span><br><span class="line">7c86d8f</span><br><span class="line">7c86d8f</span><br><span class="line">7c86d8f</span><br><span class="line">7c86d8f7</span><br><span class="line">7c86d8f7</span><br><span class="line">7c86d8f7</span><br><span class="line">7c86d8f7d</span><br><span class="line">7c86d8f7d</span><br><span class="line">7c86d8f7d</span><br><span class="line">7c86d8f7d</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6</span><br><span class="line">7c86d8f7d6d</span><br><span class="line">7c86d8f7d6d</span><br><span class="line">7c86d8f7d6d</span><br><span class="line">7c86d8f7d6de</span><br><span class="line">7c86d8f7d6de</span><br><span class="line">7c86d8f7d6de</span><br><span class="line">7c86d8f7d6de</span><br><span class="line">7c86d8f7d6de</span><br><span class="line">7c86d8f7d6de3</span><br><span class="line">7c86d8f7d6de3</span><br><span class="line">7c86d8f7d6de3</span><br><span class="line">7c86d8f7d6de33</span><br><span class="line">7c86d8f7d6de33</span><br><span class="line">7c86d8f7d6de33a</span><br><span class="line">7c86d8f7d6de33a</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a8</span><br><span class="line">7c86d8f7d6de33a87</span><br><span class="line">7c86d8f7d6de33a87</span><br><span class="line">7c86d8f7d6de33a87</span><br><span class="line">7c86d8f7d6de33a87</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f</span><br><span class="line">7c86d8f7d6de33a87f7</span><br><span class="line">7c86d8f7d6de33a87f7</span><br><span class="line">7c86d8f7d6de33a87f7</span><br><span class="line">7c86d8f7d6de33a87f7f</span><br><span class="line">7c86d8f7d6de33a87f7f</span><br><span class="line">7c86d8f7d6de33a87f7f</span><br><span class="line">7c86d8f7d6de33a87f7f9</span><br><span class="line">7c86d8f7d6de33a87f7f9</span><br><span class="line">7c86d8f7d6de33a87f7f9</span><br><span class="line">7c86d8f7d6de33a87f7f9</span><br><span class="line">7c86d8f7d6de33a87f7f9d</span><br><span class="line">7c86d8f7d6de33a87f7f9d</span><br><span class="line">7c86d8f7d6de33a87f7f9d</span><br><span class="line">7c86d8f7d6de33a87f7f9d6</span><br><span class="line">7c86d8f7d6de33a87f7f9d6</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b0</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b0</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b0</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b00</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b00</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005c</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005c</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005c</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005c</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce6</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce6</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce6</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce64</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce64</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br></pre></td></tr></table></figure>
<p>得到隐写段:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7c86d8f7d6de33a87f7f9d6b005ce640</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Jiu jue</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/08/16/buuctf-8/">http://example.com/2022/08/16/buuctf-8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Jiu jue's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RSA/">RSA</a><a class="post-meta__tags" href="/tags/classic/">classic</a><a class="post-meta__tags" href="/tags/base64/">base64</a></div><div class="post_share"><div class="social-share" data-image="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/16/buuctf-9/"><img class="prev-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF-Crypto-Wp 81~90</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/16/buuctf-7/"><img class="next-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF-Crypto-Wp 61~70</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 51~60</div></div></a></div><div><a href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 61~70</div></div></a></div><div><a href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 41~50</div></div></a></div><div><a href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 81~90</div></div></a></div><div><a href="/2022/08/16/buuctf-4/" title="BUUCTF-Crypto-Wp 31~40"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/93ffdda9-7931-4753-aee3-0c05df7bc9b5.bmp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 31~40</div></div></a></div><div><a href="/2022/07/29/buuctf-2/" title="BUUCTF-Crypto-Wp 11~20"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220630161826.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-29</div><div class="title">BUUCTF-Crypto-Wp 11~20</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jiu jue</div><div class="author-info__description">记录学习Crypto的过程</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jiujueaa"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/jiujueaa" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://weibo.com/u/5496907948" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#71-AFCTF2018-%E4%BD%A0%E8%83%BD%E7%9C%8B%E5%87%BA%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%E4%B9%88"><span class="toc-number">1.</span> <span class="toc-text">71 [AFCTF2018]你能看出这是什么加密么</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#72-AFCTF2018-%E5%8F%AF%E6%80%9C%E7%9A%84RSA"><span class="toc-number">2.</span> <span class="toc-text">72 [AFCTF2018]可怜的RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#73-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-classic0"><span class="toc-number">3.</span> <span class="toc-text">73 [ACTF新生赛2020]crypto-classic0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#74-RoarCTF2019-babyRSA%EF%BC%88%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">74 [RoarCTF2019]babyRSA（威尔逊定理）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#75-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-boom"><span class="toc-number">5.</span> <span class="toc-text">75 [网鼎杯 2020 青龙组]boom</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#76-RoarCTF2019-RSA"><span class="toc-number">6.</span> <span class="toc-text">76 [RoarCTF2019]RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#77-WUSTCTF2020-B-se"><span class="toc-number">7.</span> <span class="toc-text">77 [WUSTCTF2020]B@se</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#78-%E9%B8%A1%E8%97%95%E6%A4%92%E7%9B%90%E5%91%B3"><span class="toc-number">8.</span> <span class="toc-text">78 鸡藕椒盐味</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#79-AFCTF2018-Single"><span class="toc-number">9.</span> <span class="toc-text">79 [AFCTF2018]Single</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#80-RSA-amp-what%EF%BC%88base64%E9%9A%90%E5%86%99"><span class="toc-number">10.</span> <span class="toc-text">80 RSA &amp; what（base64隐写)</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 81~90"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90">BUUCTF-Crypto-Wp 81~90</a><time datetime="2022-08-15T21:25:30.000Z" title="发表于 2022-08-16 05:25:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 71~80"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80">BUUCTF-Crypto-Wp 71~80</a><time datetime="2022-08-15T21:23:30.000Z" title="发表于 2022-08-16 05:23:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 61~70"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70">BUUCTF-Crypto-Wp 61~70</a><time datetime="2022-08-15T21:20:10.000Z" title="发表于 2022-08-16 05:20:10">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 51~60"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60">BUUCTF-Crypto-Wp 51~60</a><time datetime="2022-08-15T21:16:31.000Z" title="发表于 2022-08-16 05:16:31">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 41~50"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50">BUUCTF-Crypto-Wp 41~50</a><time datetime="2022-08-15T21:12:21.000Z" title="发表于 2022-08-16 05:12:21">2022-08-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Jiu jue</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><div class="aplayer no-destroy" data-id="001LY73007BS3u" data-server="tencent" data-type="song" data-fixed="true" data-autoplay="false"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>