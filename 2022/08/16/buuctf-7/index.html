<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF-Crypto-Wp 61~70 | Jiu jue's blog</title><meta name="keywords" content="Crypto"><meta name="author" content="Jiu jue"><meta name="copyright" content="Jiu jue"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="BUUCTF刷题笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-Crypto-Wp 61~70">
<meta property="og:url" content="http://example.com/2022/08/16/buuctf-7/index.html">
<meta property="og:site_name" content="Jiu jue&#39;s blog">
<meta property="og:description" content="BUUCTF刷题笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png">
<meta property="article:published_time" content="2022-08-15T21:20:10.000Z">
<meta property="article:modified_time" content="2022-08-15T21:21:13.397Z">
<meta property="article:author" content="Jiu jue">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="classic">
<meta property="article:tag" content="vigenere">
<meta property="article:tag" content="XOR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png"><link rel="shortcut icon" href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9377_cugan_noise3_4x_i1.00.PNG"><link rel="canonical" href="http://example.com/2022/08/16/buuctf-7/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jiu jue","link":"链接: ","source":"来源: Jiu jue's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF-Crypto-Wp 61~70',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-16 05:21:13'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jiu jue's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF-Crypto-Wp 61~70</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-15T21:20:10.000Z" title="发表于 2022-08-16 05:20:10">2022-08-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-15T21:21:13.397Z" title="更新于 2022-08-16 05:21:13">2022-08-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF-Crypto-Wp 61~70"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="61-GWCTF-2019-BabyRSA"><a href="#61-GWCTF-2019-BabyRSA" class="headerlink" title="61 [GWCTF 2019]BabyRSA"></a>61 [GWCTF 2019]BabyRSA</h1><p>给了N和m1,m2，flag被拆成f1与f2，其中m1和m2分别为f1+f2与f1\^3+f2^3,解方程能解出f1,f2，转换成字符串拼接一下就是原flag了，以下为加密文件：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N=&#x27;</span> + <span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m1=&#x27;</span> + <span class="built_in">str</span>(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m2=&#x27;</span> + <span class="built_in">str</span>(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br></pre></td></tr></table></figure>
<p>p和q通过在线工具解出来，反推c1和c2后解方程，最后拼接，解题脚本如下:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.abc <span class="keyword">import</span> a,b,c </span><br><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">p= <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span></span><br><span class="line">q= <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">c1=<span class="built_in">pow</span>(m1,d,N)</span><br><span class="line">c2=<span class="built_in">pow</span>(m2,d,N)</span><br><span class="line">aa=solve([a+b-c1,<span class="built_in">pow</span>(a,<span class="number">3</span>)+<span class="built_in">pow</span>(b,<span class="number">3</span>)-c2],[a,b])</span><br><span class="line"><span class="built_in">print</span>(aa)</span><br><span class="line">f1=<span class="number">1141553212031156130619789508463772513350070909</span></span><br><span class="line">f2=<span class="number">1590956290598033029862556611630426044507841845</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(f2)+long_to_bytes(f1))</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;GWHT&#123;f709e0e2cfe7e530ca8972959a1033b2&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="62-一张谍报"><a href="#62-一张谍报" class="headerlink" title="62 一张谍报"></a>62 一张谍报</h1><p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" alt=""></p>
<p>分析一下两端文字的内容，很容易发现这是个自定义的替换密码，写脚本解密:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1=<span class="string">&#x27;今天上午，朝歌区梆子公司决定，在每天三更天不亮免费在各大小区门口设卡为全城提供二次震耳欲聋的敲更提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的符号是前进。为此，全区老人都蹲在该公司东边树丛合力抵制，不给公司人员放行，场面混乱。李罗鹰住进朝歌区五十年了，人称老鹰头，几年孙子李虎南刚从东北当猎户回来，每月还寄回来几块鼹鼠干。李罗鹰当年遇到的老婆是朝歌一枝花，所以李南虎是长得非常秀气的一个汉子。李罗鹰表示：无论梆子公司做的对错，反正不能打扰他孙子睡觉，子曰：‘睡觉乃人之常情’。梆子公司这是连菩萨睡觉都不放过啊。李南虎表示：梆子公司智商捉急，小心居民猴急跳墙！这三伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，更有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李南虎仍旧表示爷爷年纪大了，睡不好对身体不好。&#x27;</span></span><br><span class="line">str2=<span class="string">&#x27;喵天上午，汪歌区哞叽公司决定，在每天八哇天不全免费在各大小区门脑设卡为全城提供双次震耳欲聋的敲哇提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的编号是前进。为此，全区眠人都足在该公司流边草丛合力抵制，不给公司人员放行，场面混乱。李罗鸟住进汪歌区五十年了，人称眠鸟顶，几年孙叽李熬值刚从流北当屁户回来，每月还寄回来几块报信干。李罗鸟当年遇到的眠婆是汪歌一枝花，所以李值熬是长得非常秀气的一个汉叽。李罗鸟表示：无论哞叽公司做的对错，反正不能打扰他孙叽睡觉，叽叶：‘睡觉乃人之常情’。哞叽公司这是连衣服睡觉都不放过啊。李值熬表示：哞叽公司智商捉急，小心居民猴急跳墙！这八伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，哇有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李值熬仍旧表示爷爷年纪大了，睡不好对身体不好。&#x27;</span></span><br><span class="line">str3=<span class="string">&#x27;喵汪哞叽双哇顶，眠鸟足屁流脑，八哇报信断流脑全叽，眠鸟进北脑上草，八枝遇孙叽，孙叽对熬编叶：值天衣服放鸟捉猴顶。鸟对：北汪罗汉伏熬乱天门。合编放行，卡编扯呼。人离烧草，报信归洞，孙叽找爷爷。&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str3)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str2)):</span><br><span class="line">        <span class="keyword">if</span> str3[i]==str2[j]:</span><br><span class="line">            flag+=str1[j]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">今朝梆子二更头，老鹰蹲猎东口，三更鼹鼠断东口亮子，老鹰进北口上树，三枝遇孙子，孙子对虎符曰：南天菩萨放鹰捉猴头。鹰对：北朝罗汉伏虎乱天门。合符放行，卡符扯呼。人离烧树，鼹鼠归洞，孙子找爷爷。</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">南天菩萨放鹰捉猴头</span><br></pre></td></tr></table></figure>
<h1 id="63-SameMod"><a href="#63-SameMod" class="headerlink" title="63 SameMod"></a>63 SameMod</h1><p>一道共模攻击的题目，直接进行一个脚本的写:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">c1=<span class="number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span></span><br><span class="line"></span><br><span class="line">e1=<span class="number">773</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span></span><br><span class="line"></span><br><span class="line">e2=<span class="number">839</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_gong_N_def</span>(<span class="params">e1,e2,c1,c2,n</span>):<span class="comment">#共模攻击解m</span></span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e1,e2:&quot;</span>,e1,e2)</span><br><span class="line">    <span class="built_in">print</span>(gmpy2.gcd(e1,e2))</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"> </span><br><span class="line">m = rsa_gong_N_def(e1,e2,c1,c2,n)</span><br><span class="line"><span class="comment"># print(long_to_bytes(m))#正整数转bytes字符串输出</span></span><br><span class="line">str1=<span class="built_in">str</span>(m)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(str1):</span><br><span class="line">    <span class="keyword">if</span> str1[i]==<span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        c=<span class="built_in">chr</span>(<span class="built_in">int</span>(str1[i:i+<span class="number">3</span>]))</span><br><span class="line">        i+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c=<span class="built_in">chr</span>(<span class="built_in">int</span>(str1[i:i+<span class="number">2</span>]))</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    flag+=c</span><br><span class="line"><span class="built_in">print</span>(flag)<span class="comment">#long类型拆分转ascii</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>一开始想直接long_to_bytes求flag，发现好像行不通，后来尝试用ascii解后得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;whenwethinkitispossible&#125;</span><br></pre></td></tr></table></figure>
<h1 id="64-ACTF新生赛2020-crypto-rsa3"><a href="#64-ACTF新生赛2020-crypto-rsa3" class="headerlink" title="64 [ACTF新生赛2020]crypto-rsa3"></a>64 [ACTF新生赛2020]crypto-rsa3</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n=177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span><br><span class="line">c=1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span><br><span class="line">e=65537</span><br></pre></td></tr></table></figure>
<p>给了n,c,e，在线工具拆n，直接解：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">n=<span class="number">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span></span><br><span class="line">p=<span class="number">13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179231</span></span><br><span class="line">q=<span class="number">13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179293</span></span><br><span class="line">c=<span class="number">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;actf&#123;p_and_q_should_not_be_so_close_in_value&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="65-NPUCTF2020-这是什么觅🐎"><a href="#65-NPUCTF2020-这是什么觅🐎" class="headerlink" title="65 [NPUCTF2020]这是什么觅🐎"></a>65 [NPUCTF2020]这是什么觅🐎</h1><p>附件用Hex Fiend打开后：</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/11.tiff" alt=""></p>
<p>看到这是zip的前缀，内含文件flag.jpg:</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/flag.jpg" alt=""></p>
<p>日历底部有一串文字：</p>
<blockquote>
<p>F1 W1 S22 S21 T12 S11 W1 S13</p>
</blockquote>
<p>其中字母对应的应该是星期几，由于有两个T和S，所以用1和2来区别，那么对着表解就有：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>密文</th>
<th>日期</th>
<th>解码</th>
</tr>
</thead>
<tbody>
<tr>
<td>F1</td>
<td>3</td>
<td>c</td>
</tr>
<tr>
<td>W1</td>
<td>1</td>
<td>a</td>
</tr>
<tr>
<td>S22</td>
<td>12</td>
<td>l</td>
</tr>
<tr>
<td>S21</td>
<td>5</td>
<td>e</td>
</tr>
<tr>
<td>T12</td>
<td>14</td>
<td>n</td>
</tr>
<tr>
<td>S11</td>
<td>4</td>
<td>d</td>
</tr>
<tr>
<td>W1</td>
<td>1</td>
<td>a</td>
</tr>
<tr>
<td>S13</td>
<td>18</td>
<td>r</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>日期对应的是二十六个字母的序号，故解码得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">calendar</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="66-浪里淘沙"><a href="#66-浪里淘沙" class="headerlink" title="66 浪里淘沙"></a>66 浪里淘沙</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample</span><br></pre></td></tr></table></figure>
<p>密文字典：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;tonight&#x27;,&#x27;success&#x27;,&#x27;notice&#x27;,&#x27;example&#x27;,&#x27;should&#x27;,&#x27;crypto&#x27;,&#x27;backspace&#x27;,&#x27;learn&#x27;,&#x27;found&#x27;,&#x27;morning&#x27;,&#x27;we&#x27;,&#x27;system&#x27;,&#x27;sublim&#x27;,&#x27;the&#x27;,&#x27;user&#x27;,&#x27;enter&#x27;</span><br></pre></td></tr></table></figure>
<p>词频分析:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>( <span class="string">&#x27;/Users/kaijay/Downloads/浪里淘沙.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span> ).read()</span><br><span class="line">word = [<span class="string">&#x27;tonight&#x27;</span>,<span class="string">&#x27;success&#x27;</span>,<span class="string">&#x27;notice&#x27;</span>,<span class="string">&#x27;example&#x27;</span>,<span class="string">&#x27;should&#x27;</span>,<span class="string">&#x27;crypto&#x27;</span>,<span class="string">&#x27;backspace&#x27;</span>,<span class="string">&#x27;learn&#x27;</span>,<span class="string">&#x27;found&#x27;</span>,<span class="string">&#x27;morning&#x27;</span>,<span class="string">&#x27;we&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;sublim&#x27;</span>,<span class="string">&#x27;the&#x27;</span>,<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;enter&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> word:</span><br><span class="line">        <span class="built_in">print</span>(s,f.count(s))</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tonight 117</span><br><span class="line">success 138</span><br><span class="line">notice 136</span><br><span class="line">example 139</span><br><span class="line">should 131</span><br><span class="line">crypto 141</span><br><span class="line">backspace 129</span><br><span class="line">learn 134</span><br><span class="line">found 125</span><br><span class="line">morning 113</span><br><span class="line">we 124</span><br><span class="line">system 130</span><br><span class="line">sublim 132</span><br><span class="line">the 140</span><br><span class="line">user 133</span><br><span class="line">enter 120</span><br></pre></td></tr></table></figure>
<p>排序后:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">morning tonight enter we found backspace system should sublim user learn notice success example the crypto</span><br></pre></td></tr></table></figure>
<p>拼接4,8,11,15,16位就是:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">we should learn the crypto</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="67-BJDCTF2020-easyrsa"><a href="#67-BJDCTF2020-easyrsa" class="headerlink" title="67 [BJDCTF2020]easyrsa"></a>67 [BJDCTF2020]easyrsa</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br></pre></td></tr></table></figure>
<p>对加密脚本中的z分析：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
z=\frac{1}{\frac{1}{1+p^2}}-\frac{1}{\frac{1}{1-q^2}}=1+p^2-1+q^2=p^2+q^2</script><p>同时又因为：</p>
<script type="math/tex; mode=display">
n=p*q</script><p>可以解出p和q</p>
<p>其实p和q也可以直接用在线工具分解n拆出来，直接解：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">n=<span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line">p=<span class="number">105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141</span></span><br><span class="line">q=<span class="number">144564833334456076455156647979862690498796694770100520405218930055633597500009574663803955456004439398699669751249623406199542605271188909145969364476344963078599240058180033000440459281558347909876143313940657252737586803051935392596519226965519859474501391969755712097119163926672753588797180811711004203301</span></span><br><span class="line">c=<span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;BJD&#123;Advanced_mathematics_is_too_hard!!!&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="68-yxx"><a href="#68-yxx" class="headerlink" title="68 yxx"></a>68 yxx</h1><p>密文：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">V</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>明文：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lovelovelovelovelovelovelovelove</span><br></pre></td></tr></table></figure>
<p>hex打开：</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220718100527.png" alt=""></p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220718100548.png" alt=""></p>
<p>上脚本异或，没啥好说的:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hex1 = <span class="string">&#x27;0A031702 56011511 0A140E0A 1E300E0A 1E300E0A 1E30140C 190D1F10 0E060318&#x27;</span></span><br><span class="line">hex2 = <span class="string">&#x27;6C6F7665 6C6F7665 6C6F7665 6C6F7665 6C6F7665 6C6F7665 6C6F7665 6C6F7665&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hextobin</span>(<span class="params"><span class="built_in">hex</span></span>):</span><br><span class="line">    <span class="built_in">bin</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">hex</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0000&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0001&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0010&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0011&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0100&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0101&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0110&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;7&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;0111&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;8&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1000&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1001&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1010&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1011&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1100&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1101&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1110&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;F&#x27;</span>:</span><br><span class="line">            <span class="built_in">bin</span> += <span class="string">&#x27;1111&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span></span><br><span class="line">bin1 = hextobin(hex1)</span><br><span class="line">bin2 = hextobin(hex2)</span><br><span class="line"><span class="built_in">print</span>(bin1)</span><br><span class="line"><span class="built_in">print</span>(bin2)</span><br><span class="line">bin3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bin1)):</span><br><span class="line">    bin3 += <span class="built_in">str</span>(<span class="built_in">int</span>(bin1[i]) ^ <span class="built_in">int</span>(bin2[i]))</span><br><span class="line"><span class="built_in">print</span>(bin3)</span><br></pre></td></tr></table></figure>
<p>异或结果:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0110011001101100011000010110011100111010011011100110001101110100011001100111101101111000011011110111001001011111011110000110111101110010010111110111100001101111011100100101111101100010011010010111010101100010011010010111010101100010011010010111010101111101</span><br></pre></td></tr></table></figure>
<p>转字符串:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag:nctf&#123;xor_xor_xor_biubiubiu&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="69-AFCTF2018-Vigenere"><a href="#69-AFCTF2018-Vigenere" class="headerlink" title="69 [AFCTF2018]Vigenère"></a>69 [AFCTF2018]Vigenère</h1><p>维吉尼亚密码，解码后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">When in the Course of human events it becomes necessary for one people to dissolve the political bands which have connected them with another and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature&#x27;s God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.</span><br><span class="line"></span><br><span class="line">We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness. — That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed, — That whenever any Form of Government becomes destructive of these ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its foundation on such principles and organizing its powers in such form, as to them shall seem most likely to effect their Safety and Happiness. Prudence, indeed, will dictate that Governments long established should not be changed for light and transient causes; and accordingly all experience hath shewn that mankind are more disposed to suffer, while evils are sufferable than to right themselves by abolishing the forms to which they are accustomed. But when a long train of abuses and usurpations, pursuing invariably the same Object evinces a design to reduce them under absolute Despotism, it is their right, it is their duty, to throw off such Government, and to provide new Guards for their future security. — Such has been the patient sufferance of these Colonies; and such is now the necessity which constrains them to alter their former Systems of Government. The history of the present King of Great Britain is a history of repeated injuries and usurpations, all having in direct object the establishment of an absolute Tyranny over these States. To prove this, let Facts be submitted to a candid world.</span><br><span class="line"></span><br><span class="line">He has refused his Assent to Laws, the most wholesome and necessary for the public good.</span><br><span class="line"></span><br><span class="line">He has forbidden his Governors to pass Laws of immediate and pressing importance, unless suspended in their operation till his Assent should be obtained; and when so suspended, he has utterly neglected to attend to them.</span><br><span class="line"></span><br><span class="line">He has refused to pass other Laws for the accommodation of large districts of people, unless those people would relinquish the right of Representation in the Legislature, a right inestimable to them and formidable to tyrants only.</span><br><span class="line"></span><br><span class="line">He has called together legislative bodies at places unusual, uncomfortable, and distant from the depository of their Public Records, for the sole purpose of fatiguing them into compliance with his measures.</span><br><span class="line"></span><br><span class="line">He has dissolved Representative Houses repeatedly, for opposing with manly firmness his invasions on the rights of the people.</span><br><span class="line"></span><br><span class="line">He has refused for a long time, after such dissolutions, to cause others to be elected, whereby the Legislative Powers, incapable of Annihilation, have returned to the People at large for their exercise; the State remaining in the mean time exposed to all the dangers of invasion from without, and convulsions within.</span><br><span class="line"></span><br><span class="line">He has endeavoured to prevent the population of these States; for that purpose obstructing the Laws for Naturalization of Foreigners; refusing to pass others to encourage their migrations hither, and raising the conditions of new Appropriations of Lands.</span><br><span class="line"></span><br><span class="line">He has obstructed the Administration of Justice by refusing his Assent to Laws for establishing Judiciary Powers.</span><br><span class="line"></span><br><span class="line">He has made Judges dependent on his Will alone for the tenure of their offices, and the amount and payment of their salaries.</span><br><span class="line"></span><br><span class="line">flag is afctf&#123;Whooooooo_U_Gotcha!&#125;</span><br><span class="line"></span><br><span class="line">He has erected a multitude of New Offices, and sent hither swarms of Officers to harass our people and eat out their substance.</span><br><span class="line"></span><br><span class="line">He has kept among us, in times of peace, Standing Armies without the Consent of our legislatures.</span><br><span class="line"></span><br><span class="line">He has affected to render the Military independent of and superior to the Civil Power.</span><br><span class="line"></span><br><span class="line">He has combined with others to subject us to a jurisdiction foreign to our constitution, and unacknowledged by our laws; giving his Assent to their Acts of pretended Legislation:</span><br><span class="line"></span><br><span class="line">For quartering large bodies of armed troops among us:</span><br><span class="line"></span><br><span class="line">For protecting them, by a mock Trial from punishment for any Murders which they should commit on the Inhabitants of these States:</span><br><span class="line"></span><br><span class="line">For cutting off our Trade with all parts of the world:</span><br><span class="line"></span><br><span class="line">For imposing Taxes on us without our Consent:</span><br><span class="line"></span><br><span class="line">For depriving us in many cases, of the benefit of Trial by Jury:</span><br><span class="line"></span><br><span class="line">For transporting us beyond Seas to be tried for pretended offences:</span><br><span class="line"></span><br><span class="line">For abolishing the free System of English Laws in a neighbouring Province, establishing therein an Arbitrary government, and enlarging its Boundaries so as to render it at once an example and fit instrument for introducing the same absolute rule into these Colonies</span><br><span class="line"></span><br><span class="line">For taking away our Charters, abolishing our most valuable Laws and altering fundamentally the Forms of our Governments:</span><br><span class="line"></span><br><span class="line">For suspending our own Legislatures, and declaring themselves invested with power to legislate for us in all cases whatsoever.</span><br><span class="line"></span><br><span class="line">He has abdicated Government here, by declaring us out of his Protection and waging War against us.</span><br><span class="line"></span><br><span class="line">He has plundered our seas, ravaged our coasts, burnt our towns, and destroyed the lives of our people.</span><br><span class="line"></span><br><span class="line">He is at this time transporting large Armies of foreign Mercenaries to compleat the works of death, desolation, and tyranny, already begun with circumstances of Cruelty &amp; Perfidy scarcely paralleled in the most barbarous ages, and totally unworthy the Head of a civilized nation.</span><br><span class="line"></span><br><span class="line">He has constrained our fellow Citizens taken Captive on the high Seas to bear Arms against their Country, to become the executioners of their friends and Brethren, or to fall themselves by their Hands.</span><br><span class="line"></span><br><span class="line">He has excited domestic insurrections amongst us, and has endeavoured to bring on the inhabitants of our frontiers, the merciless Indian Savages whose known rule of warfare, is an undistinguished destruction of all ages, sexes and conditions.</span><br><span class="line"></span><br><span class="line">In every stage of these Oppressions We have Petitioned for Redress in the most humble terms: Our repeated Petitions have been answered only by repeated injury. A Prince, whose character is thus marked by every act which may define a Tyrant, is unfit to be the ruler of a free people.</span><br><span class="line"></span><br><span class="line">Nor have We been wanting in attentions to our British brethren. We have warned them from time to time of attempts by their legislature to extend an unwarrantable jurisdiction over us. We have reminded them of the circumstances of our emigration and settlement here. We have appealed to their native justice and magnanimity, and we have conjured them by the ties of our common kindred to disavow these usurpations, which would inevitably interrupt our connections and correspondence. They too have been deaf to the voice of justice and of consanguinity. We must, therefore, acquiesce in the necessity, which denounces our Separation, and hold them, as we hold the rest of mankind, Enemies in War, in Peace Friends.</span><br><span class="line"></span><br><span class="line">We, therefore, the Representatives of the united States of America, in General Congress, Assembled, appealing to the Supreme Judge of the world for the rectitude of our intentions, do, in the Name, and by Authority of the good People of these Colonies, solemnly publish and declare, That these united Colonies are, and of Right ought to be Free and Independent States, that they are Absolved from all Allegiance to the British Crown, and that all political connection between them and the State of Great Britain, is and ought to be totally dissolved; and that as Free and Independent States, they have full Power to levy War, conclude Peace, contract Alliances, establish Commerce, and to do all other Acts and Things which Independent States may of right do. — And for the support of this Declaration, with a firm reliance on the protection of Divine Providence, we mutually pledge to each other our Lives, our Fortunes, and our sacred Honor.</span><br></pre></td></tr></table></figure>
<p>得到独立宣言与flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag is afctf&#123;Whooooooo_U_Gotcha!&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="70-NCTF2019-babyRSA"><a href="#70-NCTF2019-babyRSA" class="headerlink" title="70 [NCTF2019]babyRSA"></a>70 [NCTF2019]babyRSA</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">n</span>):</span><br><span class="line">    n += <span class="number">2</span> <span class="keyword">if</span> n &amp; <span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(n):</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = nextPrime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag.encode()), e, n)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目只给了c和d，但是（p-1)*(q-1)能解出来，已知p，q为两个相邻的素数，由公式：</p>
<script type="math/tex; mode=display">
e*d≡1mod(p-1)*(q-1)\\得到\\
e*d-1=k*(p-1)*(q-1)</script><p>又因为e<em>d-q位数为2064位，1024\</em>1024位素数小于等于2048位，也就是说这里的k相差了不超过16位，上脚本爆破出来：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=<span class="number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line">ed1 = e*d-<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>),<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">16</span>)):</span><br><span class="line">	<span class="keyword">if</span> ed1%k == <span class="number">0</span>:</span><br><span class="line">		p = sympy.prevprime(gmpy2.iroot(ed1//k,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">		q = sympy.nextprime(p)</span><br><span class="line">		<span class="keyword">if</span> (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*k == ed1:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure>
<p>得到p和q：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225075839</span><br><span class="line"></span><br><span class="line">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225076497</span><br></pre></td></tr></table></figure>
<p>解题：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">p=<span class="number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225075839</span></span><br><span class="line">q=<span class="number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225076497</span></span><br><span class="line">c=<span class="number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;NCTF&#123;70u2_nn47h_14_v3ry_gOO0000000d&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h1 id=""><a href="#" class="headerlink" title=" "></a> </h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://jiujueaa.github.io">Jiu jue</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/08/16/buuctf-7/">http://example.com/2022/08/16/buuctf-7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Jiu jue's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RSA/">RSA</a><a class="post-meta__tags" href="/tags/classic/">classic</a><a class="post-meta__tags" href="/tags/vigenere/">vigenere</a><a class="post-meta__tags" href="/tags/XOR/">XOR</a></div><div class="post_share"><div class="social-share" data-image="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/16/buuctf-8/"><img class="prev-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF-Crypto-Wp 71~80</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/16/buuctf-6/"><img class="next-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF-Crypto-Wp 51~60</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 51~60</div></div></a></div><div><a href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 41~50</div></div></a></div><div><a href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 71~80</div></div></a></div><div><a href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 81~90</div></div></a></div><div><a href="/2022/08/16/buuctf-4/" title="BUUCTF-Crypto-Wp 31~40"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/93ffdda9-7931-4753-aee3-0c05df7bc9b5.bmp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 31~40</div></div></a></div><div><a href="/2022/07/29/buuctf-2/" title="BUUCTF-Crypto-Wp 11~20"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220630161826.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-29</div><div class="title">BUUCTF-Crypto-Wp 11~20</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jiu jue</div><div class="author-info__description">记录学习Crypto的过程</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jiujueaa"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/jiujueaa" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://weibo.com/u/5496907948" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#61-GWCTF-2019-BabyRSA"><span class="toc-number">1.</span> <span class="toc-text">61 [GWCTF 2019]BabyRSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#62-%E4%B8%80%E5%BC%A0%E8%B0%8D%E6%8A%A5"><span class="toc-number">2.</span> <span class="toc-text">62 一张谍报</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#63-SameMod"><span class="toc-number">3.</span> <span class="toc-text">63 SameMod</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#64-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa3"><span class="toc-number">4.</span> <span class="toc-text">64 [ACTF新生赛2020]crypto-rsa3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#65-NPUCTF2020-%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E8%A7%85%F0%9F%90%8E"><span class="toc-number">5.</span> <span class="toc-text">65 [NPUCTF2020]这是什么觅🐎</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#66-%E6%B5%AA%E9%87%8C%E6%B7%98%E6%B2%99"><span class="toc-number">6.</span> <span class="toc-text">66 浪里淘沙</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#67-BJDCTF2020-easyrsa"><span class="toc-number">7.</span> <span class="toc-text">67 [BJDCTF2020]easyrsa</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#68-yxx"><span class="toc-number">8.</span> <span class="toc-text">68 yxx</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#69-AFCTF2018-Vigenere"><span class="toc-number">9.</span> <span class="toc-text">69 [AFCTF2018]Vigenère</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#70-NCTF2019-babyRSA"><span class="toc-number">10.</span> <span class="toc-text">70 [NCTF2019]babyRSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">11.</span> <span class="toc-text"> </span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 81~90"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90">BUUCTF-Crypto-Wp 81~90</a><time datetime="2022-08-15T21:25:30.000Z" title="发表于 2022-08-16 05:25:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 71~80"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80">BUUCTF-Crypto-Wp 71~80</a><time datetime="2022-08-15T21:23:30.000Z" title="发表于 2022-08-16 05:23:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 61~70"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70">BUUCTF-Crypto-Wp 61~70</a><time datetime="2022-08-15T21:20:10.000Z" title="发表于 2022-08-16 05:20:10">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 51~60"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60">BUUCTF-Crypto-Wp 51~60</a><time datetime="2022-08-15T21:16:31.000Z" title="发表于 2022-08-16 05:16:31">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 41~50"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50">BUUCTF-Crypto-Wp 41~50</a><time datetime="2022-08-15T21:12:21.000Z" title="发表于 2022-08-16 05:12:21">2022-08-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Jiu jue</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><div class="aplayer no-destroy" data-id="001LY73007BS3u" data-server="tencent" data-type="song" data-fixed="true" data-autoplay="false"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>