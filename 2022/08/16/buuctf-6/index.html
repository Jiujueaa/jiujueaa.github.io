<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF-Crypto-Wp 51~60 | Jiu jue's blog</title><meta name="keywords" content="Crypto"><meta name="author" content="Jiu jue"><meta name="copyright" content="Jiu jue"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="BUUCTF刷题笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-Crypto-Wp 51~60">
<meta property="og:url" content="https://jiujueaa.github.io/2022/08/16/buuctf-6/index.html">
<meta property="og:site_name" content="Jiu jue&#39;s blog">
<meta property="og:description" content="BUUCTF刷题笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png">
<meta property="article:published_time" content="2022-08-15T21:16:31.000Z">
<meta property="article:modified_time" content="2022-08-15T21:29:04.635Z">
<meta property="article:author" content="Jiu jue">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="classic">
<meta property="article:tag" content="vigenere">
<meta property="article:tag" content="keyboard">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png"><link rel="shortcut icon" href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9377_cugan_noise3_4x_i1.00.PNG"><link rel="canonical" href="https://jiujueaa.github.io/2022/08/16/buuctf-6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jiu jue","link":"链接: ","source":"来源: Jiu jue's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF-Crypto-Wp 51~60',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-16 05:29:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/copyright.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jiu jue's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF-Crypto-Wp 51~60</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-15T21:16:31.000Z" title="发表于 2022-08-16 05:16:31">2022-08-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-15T21:29:04.635Z" title="更新于 2022-08-16 05:29:04">2022-08-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF-Crypto-Wp 51~60"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="51-NCTF2019-Keyboard"><a href="#51-NCTF2019-Keyboard" class="headerlink" title="51 [NCTF2019]Keyboard"></a>51 [NCTF2019]Keyboard</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee</span><br></pre></td></tr></table></figure>
<p>题目内容和键盘有关，给的密文只有26键中第一排的字母，第一排有十个字母，应该是对应九键键盘中的0~9，字母个数应该是九键中对应的第几个字母，简单的替换密码，直接对着键盘就能写出:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">youaresosmartthatthisisjustapieceofcake</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="52-BJDCTF2020-RSA"><a href="#52-BJDCTF2020-RSA" class="headerlink" title="52 [BJDCTF2020]RSA"></a>52 [BJDCTF2020]RSA</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">题目的输出是：</span><br><span class="line"></span><br><span class="line">c1=12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span><br><span class="line">n1=13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">x=381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">c2=979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span><br><span class="line">n2=12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br></pre></td></tr></table></figure>
<p>其中x为</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span>(<span class="number">294</span>,e,n1)</span><br></pre></td></tr></table></figure>
<p>的输出，可以先暴力枚举将e求出，再用最大公约数法求出p和N：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c1=<span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span></span><br><span class="line">n1=<span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">x=<span class="number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line">c2=<span class="number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span></span><br><span class="line">n2=<span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">n=[n1,n2]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(<span class="number">294</span>,i,n1)==x:</span><br><span class="line">        e=i</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span>(gcd(n[i],n[j])!=<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(i,j)</span><br><span class="line">            N=n[i]</span><br><span class="line">            p=gcd(n[i],n[j])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,N)</span><br><span class="line">q=N//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c1,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;BJD&#123;p_is_common_divisor&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h1 id="53-MRCTF2020-天干地支-甲子"><a href="#53-MRCTF2020-天干地支-甲子" class="headerlink" title="53 [MRCTF2020]天干地支+甲子"></a>53 [MRCTF2020]天干地支+甲子</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">得到得字符串用MRCTF&#123;&#125;包裹</span><br><span class="line">一天Eki收到了一封来自Sndav的信，但是他有点迷希望您来解决一下</span><br><span class="line">甲戌 </span><br><span class="line">甲寅 </span><br><span class="line">甲寅 </span><br><span class="line">癸卯 </span><br><span class="line">己酉 </span><br><span class="line">甲寅 </span><br><span class="line">辛丑 </span><br></pre></td></tr></table></figure>
<p>对应六十甲子顺序表有：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>原码</th>
<th>解码</th>
<th>+甲子</th>
<th>Ascii解码</th>
</tr>
</thead>
<tbody>
<tr>
<td>甲戌</td>
<td>11</td>
<td>71</td>
<td>G</td>
</tr>
<tr>
<td>甲寅</td>
<td>51</td>
<td>111</td>
<td>o</td>
</tr>
<tr>
<td>甲寅</td>
<td>51</td>
<td>111</td>
<td>o</td>
</tr>
<tr>
<td>癸卯</td>
<td>40</td>
<td>100</td>
<td>d</td>
</tr>
<tr>
<td>己酉</td>
<td>46</td>
<td>106</td>
<td>j</td>
</tr>
<tr>
<td>甲寅</td>
<td>51</td>
<td>111</td>
<td>o</td>
</tr>
<tr>
<td>辛丑</td>
<td>38</td>
<td>98</td>
<td>b</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Goodjob&#125;</span><br></pre></td></tr></table></figure>
<h1 id="54-BJDCTF2020-rsa-output"><a href="#54-BJDCTF2020-rsa-output" class="headerlink" title="54 [BJDCTF2020]rsa_output"></a>54 [BJDCTF2020]rsa_output</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767&#125;</span><br><span class="line"></span><br><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659&#125;</span><br><span class="line"></span><br><span class="line">message1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line"></span><br><span class="line">message2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br></pre></td></tr></table></figure>
<p>题目给出了n,c1,c2,e1,e2，直接采用共模攻击：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">c1=<span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line"></span><br><span class="line">e1=<span class="number">2767</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line"></span><br><span class="line">e2=<span class="number">3659</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_gong_N_def</span>(<span class="params">e1,e2,c1,c2,n</span>):<span class="comment">#共模攻击解m</span></span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e1,e2:&quot;</span>,e1,e2)</span><br><span class="line">    <span class="built_in">print</span>(gmpy2.gcd(e1,e2))</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"> </span><br><span class="line">m = rsa_gong_N_def(e1,e2,c1,c2,n)</span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))<span class="comment">#正整数转bytes字符串输出</span></span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e1,e2: 2767 3659</span><br><span class="line">1</span><br><span class="line">(mpz(1), mpz(-201), mpz(152))</span><br><span class="line">b&#x27;BJD&#123;r3a_C0mmoN_moD@_4ttack&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="55-RSA4"><a href="#55-RSA4" class="headerlink" title="55 RSA4"></a>55 RSA4</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">N = 331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004 </span><br><span class="line">c = 310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span><br><span class="line"></span><br><span class="line">N = 302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114 </span><br><span class="line">c = 112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span><br><span class="line"></span><br><span class="line">N = 332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323 </span><br><span class="line">c = 10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span><br></pre></td></tr></table></figure>
<p>分析：</p>
<blockquote>
<p>N1,N2,N3两两互质</p>
<p>c1=m^e mod n1 </p>
<p>c2=m^e mod n2 </p>
<p>c3=m^e mod n3</p>
<p>当m^e&lt;n1,n2,n3时,<strong>所以当m和e足够小时才可以用这个方法</strong></p>
<p>m^e=c1 mod n1</p>
<p>m^e=c2 mod n2</p>
<p>m^e=c3 mod n3</p>
<p>N=n1*n2*n3</p>
<p>N1=N/N1,N2=N/N2,N3=N/N3</p>
<p>根据中国剩余定理：</p>
<p>m^e=c1*N1*invert(N1,n1)+c2*N2*invert(N2,n2)+c3*N3*invert(N3,n3) mod N </p>
<p>invert(N2,n2)是N2对n2的逆元。</p>
<p>对m^e开e次根就可以求出m。</p>
</blockquote>
<p>脚本:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert,iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1=<span class="built_in">int</span>(<span class="string">&#x27;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&#x27;</span>,<span class="number">5</span>)<span class="comment">#5进制转10进制</span></span><br><span class="line">c1=<span class="built_in">int</span>(<span class="string">&#x27;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">n2=<span class="built_in">int</span>(<span class="string">&#x27;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">c2=<span class="built_in">int</span>(<span class="string">&#x27;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">n3=<span class="built_in">int</span>(<span class="string">&#x27;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">c3=<span class="built_in">int</span>(<span class="string">&#x27;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">n=[n1,n2,n3]</span><br><span class="line">c=[c1,c2,c3]</span><br><span class="line">N=<span class="number">1</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n:</span><br><span class="line">    N=N*i<span class="comment">#求N=n1*n2*n3</span></span><br><span class="line">m_e=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    m_e+=c[j]*N//n[j]*invert(N//n[j],n[j])</span><br><span class="line">m_e=m_e%N</span><br><span class="line">m, f = iroot(m_e, e)<span class="comment">#对m^e开e次方</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;noxCTF&#123;D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h1 id="56-ACTF新生赛2020-crypto-rsa0"><a href="#56-ACTF新生赛2020-crypto-rsa0" class="headerlink" title="56 [ACTF新生赛2020]crypto-rsa0"></a>56 [ACTF新生赛2020]crypto-rsa0</h1><p>附件居然要密码才能打开，hint说是伪加密，</p>
<blockquote>
<p>一个zip文件有三个部分组成：</p>
<p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志 </p>
<p>这是三个头标记，主要看第二个</p>
<p>压缩源文件数据区：50 4B 03 04：这是头文件标记</p>
<p>压缩源文件目录区：</p>
<p>50 4B 01 02：目录中文件文件头标记</p>
<p>3F 00：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p>
<p>压缩源文件目录结束标志 ：50 4B 05 06：目录结束标记</p>
</blockquote>
<p>用<strong>Hex Fiend</strong>打开zip文件后查找50 4B：</p>
<p>可以看到存在伪加密标志09 00:</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/%E4%BC%AA%E5%8A%A0%E5%AF%86%E5%AE%9E%E4%BE%8B.tiff" alt=""></p>
<p>将09 00 改成00 00后：</p>
<p><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714151139.png" alt=""></p>
<p>继续用Hex Fiend打开unix可执行文件，得到rsa0.py中输出的p,q,c</p>
<p>正常解密即可：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=<span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line">q=<span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line">c=<span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;actf&#123;n0w_y0u_see_RSA&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>很有意思的一道题</p>
<h1 id="57-BJDCTF2020-signin"><a href="#57-BJDCTF2020-signin" class="headerlink" title="57 [BJDCTF2020]signin"></a>57 [BJDCTF2020]signin</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">welcome to crypto world！！</span><br><span class="line">密文：424a447b57653163306d655f74345f424a444354467d</span><br></pre></td></tr></table></figure>
<p>十六进制转字符串后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BJD&#123;We1c0me_t4_BJDCTF&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="58-MRCTF2020-vigenere"><a href="#58-MRCTF2020-vigenere" class="headerlink" title="58 [MRCTF2020]vigenere"></a>58 [MRCTF2020]vigenere</h1><p>密文与维吉尼亚密码有关，在线解密后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a declaration of the independence of cyberspace</span><br><span class="line">by john perry barlow </span><br><span class="line">governments of the industrial world, you weary giants of flesh and steel, i come from cyberspace, the new home of mind. on behalf of the future, i ask you of the past to leave us alone. you are not welcome among us. you have no sovereignty where we gather.</span><br><span class="line">we have no elected government, nor are we likely to have one, so i address you with no greater authority than that with which liberty itself always speaks. i declare the global social space we are building to be naturally independent of the tyrannies you seek to impose on us. you have no moral right to rule us nor do you possess any methods of enforcement we have true reason to fear.</span><br><span class="line">governments derive their just powers from the consent of the governed. you have neither solicited nor received ours. we did not invite you. you do not know us, nor do you know our world. cyberspace does not lie within your borders. do not think that you can build it, as though it were a public construction project. you cannot. it is an act of nature and it grows itself through our collective actions.</span><br><span class="line">you have not engaged in our great and gathering conversation, nor did you create the wealth of our marketplaces. you do not know our culture, our ethics, or the unwritten codes that already provide our society more order than could be obtained by any of your impositions.</span><br><span class="line">you claim there are problems among us that you need to solve. you use this claim as an excuse to invade our precincts. many of these problems don&#x27;t exist. where there are real conflicts, where there are wrongs, we will identify them and address them by our means. we are forming our own social contract. this governance will arise according to the conditions of our world, not yours. our world is different.</span><br><span class="line">cyberspace consists of transactions, relationships, and thought itself, arrayed like a standing wave in the web of our communications. ours is a world that is both everywhere and nowhere, but it is not where bodies live.</span><br><span class="line">we are creating a world that all may enter without privilege or prejudice accorded by race, economic power, military force, or station of birth.</span><br><span class="line">we are creating a world where anyone, anywhere may express his or her beliefs, no matter how singular, without fear of being coerced into silence or conformity.</span><br><span class="line">your legal concepts of property, expression, identity, movement, and context do not apply to us. they are all based on matter, and there is no matter here.</span><br><span class="line">our identities have no bodies, so, unlike you, we cannot obtain order by physical coercion. we believe that from ethics, enlightened self-interest, and the commonweal, our governance will emerge. our identities may be distributed across many of your jurisdictions. the only law that all our constituent cultures would generally recognize is the golden rule. we hope we will be able to build our particular solutions on that basis. but we cannot accept the solutions you are attempting to impose.</span><br><span class="line">in the united states, you have today created a law, the telecommunications reform act, which repudiates your own constitution and insults the dreams of jefferson, washington, mill, madison, detoqueville, and brandeis. these dreams must now be born anew in us.</span><br><span class="line">you are terrified of your own children, since they are natives in a world where you will always be immigrants. because you fear them, you entrust your bureaucracies with the parental responsibilities you are too cowardly to confront yourselves. in our world, all the sentiments and expressions of humanity, from the debasing to the angelic, are parts of a seamless whole, the global conversation of bits. we cannot separate the air that chokes from the air upon which wings beat.</span><br><span class="line">in china, germany, france, russia, singapore, italy and the united states, you are trying to ward off the virus of liberty by erecting guard posts at the frontiers of cyberspace. these may keep out the contagion for a small time, but they will not work in a world that will soon be blanketed in bit-bearing media.</span><br><span class="line">your increasingly obsolete information industries would perpetuate themselves by proposing laws, in america and elsewhere, that claim to own speech itself throughout the world. these laws would declare ideas to be another industrial product, no more noble than pig iron. in our world, whatever the human mind may create can be reproduced and distributed infinitely at no cost. the global conveyance of thought no longer requires your factories to accomplish.</span><br><span class="line">these increasingly hostile and colonial measures place us in the same position as those previous lovers of freedom and self-determination who had to reject the authorities of distant, uninformed powers. we must declare our virtual selves immune to your sovereignty, even as we continue to consent to your rule over our bodies. we will spread ourselves across the planet so that no one can arrest our thoughts.</span><br><span class="line">we will create a civilization of the mind in cyberspace. may it be more humane and fair than the world your governments have made before.</span><br><span class="line">flag is mrctf vigenere crypto crack man, please add underscore and curly braces.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mrctf&#123;vigenere_crypto_crack_man&#125;</span><br></pre></td></tr></table></figure>
<h1 id="59-MRCTF2020-keyboard"><a href="#59-MRCTF2020-keyboard" class="headerlink" title="59 [MRCTF2020]keyboard"></a>59 [MRCTF2020]keyboard</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">得到的flag用</span><br><span class="line">MRCTF&#123;xxxxxx&#125;形式上叫</span><br><span class="line">都为小写字母</span><br><span class="line"></span><br><span class="line">6 </span><br><span class="line">666 </span><br><span class="line">22 </span><br><span class="line">444 </span><br><span class="line">555 </span><br><span class="line">33 </span><br><span class="line">7 </span><br><span class="line">44 </span><br><span class="line">666 </span><br><span class="line">66 </span><br><span class="line">3 </span><br></pre></td></tr></table></figure>
<p>我的评价是：不如#51</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mobilephone</span><br></pre></td></tr></table></figure>
<h1 id="60-WUSTCTF2020-babyrsa"><a href="#60-WUSTCTF2020-babyrsa" class="headerlink" title="60 [WUSTCTF2020]babyrsa"></a>60 [WUSTCTF2020]babyrsa</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c = 28767758880940662779934612526152562406674613203406706867456395986985664083182</span><br><span class="line">n = 73069886771625642807435783661014062604264768481735145873508846925735521695159</span><br><span class="line">e = 65537</span><br></pre></td></tr></table></figure>
<p>在线工具解p和q，直接上脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">p=<span class="number">189239861511125143212536989589123569301</span></span><br><span class="line">q=<span class="number">386123125371923651191219869811293586459</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;wctf2020&#123;just_@_piece_0f_cak3&#125;&#x27;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>BUUCTF-Crypto-Wp 51~60</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://jiujueaa.github.io/2022/08/16/buuctf-6/">https://jiujueaa.github.io/2022/08/16/buuctf-6/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="display: inline-block;width: 120px"><h>作者</h><div class="post-copyright-cc-info"><h>Jiu jue</h></div></div><div class="post-copyright-c" style="display: inline-block;width: 120px"><h>发布于</h><div class="post-copyright-cc-info"><h>2022-08-16</h></div></div><div class="post-copyright-u" style="display: inline-block;width: 120px"><h>更新于</h><div class="post-copyright-cc-info"><h>2022-08-16</h></div></div><div class="post-copyright-c" style="display: inline-block;width: 120px"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RSA/">RSA</a><a class="post-meta__tags" href="/tags/classic/">classic</a><a class="post-meta__tags" href="/tags/vigenere/">vigenere</a><a class="post-meta__tags" href="/tags/keyboard/">keyboard</a></div><div class="post_share"><div class="social-share" data-image="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9381.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" target="_blank"><img class="post-qr-code-img" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/IMG_9382.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/16/buuctf-7/"><img class="prev-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF-Crypto-Wp 61~70</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/16/buuctf-5/"><img class="next-cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF-Crypto-Wp 41~50</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 61~70</div></div></a></div><div><a href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 41~50</div></div></a></div><div><a href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 71~80</div></div></a></div><div><a href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 81~90</div></div></a></div><div><a href="/2022/08/16/buuctf-4/" title="BUUCTF-Crypto-Wp 31~40"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/93ffdda9-7931-4753-aee3-0c05df7bc9b5.bmp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">BUUCTF-Crypto-Wp 31~40</div></div></a></div><div><a href="/2022/07/29/buuctf-2/" title="BUUCTF-Crypto-Wp 11~20"><img class="cover" src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220630161826.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-29</div><div class="title">BUUCTF-Crypto-Wp 11~20</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/love.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jiu jue</div><div class="author-info__description">记录学习Crypto的过程</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jiujueaa"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/jiujueaa" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://weibo.com/u/5496907948" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#51-NCTF2019-Keyboard"><span class="toc-number">1.</span> <span class="toc-text">51 [NCTF2019]Keyboard</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#52-BJDCTF2020-RSA"><span class="toc-number">2.</span> <span class="toc-text">52 [BJDCTF2020]RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#53-MRCTF2020-%E5%A4%A9%E5%B9%B2%E5%9C%B0%E6%94%AF-%E7%94%B2%E5%AD%90"><span class="toc-number">3.</span> <span class="toc-text">53 [MRCTF2020]天干地支+甲子</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#54-BJDCTF2020-rsa-output"><span class="toc-number">4.</span> <span class="toc-text">54 [BJDCTF2020]rsa_output</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#55-RSA4"><span class="toc-number">5.</span> <span class="toc-text">55 RSA4</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#56-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa0"><span class="toc-number">6.</span> <span class="toc-text">56 [ACTF新生赛2020]crypto-rsa0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#57-BJDCTF2020-signin"><span class="toc-number">7.</span> <span class="toc-text">57 [BJDCTF2020]signin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#58-MRCTF2020-vigenere"><span class="toc-number">8.</span> <span class="toc-text">58 [MRCTF2020]vigenere</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#59-MRCTF2020-keyboard"><span class="toc-number">9.</span> <span class="toc-text">59 [MRCTF2020]keyboard</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#60-WUSTCTF2020-babyrsa"><span class="toc-number">10.</span> <span class="toc-text">60 [WUSTCTF2020]babyrsa</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/Part4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 81~90"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-9/" title="BUUCTF-Crypto-Wp 81~90">BUUCTF-Crypto-Wp 81~90</a><time datetime="2022-08-15T21:25:30.000Z" title="发表于 2022-08-16 05:25:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220719105039.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 71~80"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-8/" title="BUUCTF-Crypto-Wp 71~80">BUUCTF-Crypto-Wp 71~80</a><time datetime="2022-08-15T21:23:30.000Z" title="发表于 2022-08-16 05:23:30">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220714161612.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 61~70"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-7/" title="BUUCTF-Crypto-Wp 61~70">BUUCTF-Crypto-Wp 61~70</a><time datetime="2022-08-15T21:20:10.000Z" title="发表于 2022-08-16 05:20:10">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/20220816052742.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 51~60"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-6/" title="BUUCTF-Crypto-Wp 51~60">BUUCTF-Crypto-Wp 51~60</a><time datetime="2022-08-15T21:16:31.000Z" title="发表于 2022-08-16 05:16:31">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50"><img src="https://tuchuang935.oss-cn-hangzhou.aliyuncs.com/crypto.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF-Crypto-Wp 41~50"/></a><div class="content"><a class="title" href="/2022/08/16/buuctf-5/" title="BUUCTF-Crypto-Wp 41~50">BUUCTF-Crypto-Wp 41~50</a><time datetime="2022-08-15T21:12:21.000Z" title="发表于 2022-08-16 05:12:21">2022-08-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Jiu jue</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><div class="aplayer no-destroy" data-id="001LY73007BS3u" data-server="tencent" data-type="song" data-fixed="true" data-autoplay="false"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>